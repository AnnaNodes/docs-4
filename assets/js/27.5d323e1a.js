(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{472:function(t,e,s){"use strict";s.r(e);var a=s(8),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"cosmwasm-counter-tutorial"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cosmwasm-counter-tutorial"}},[t._v("#")]),t._v(" CosmWasm Counter Tutorial")]),t._v(" "),s("p",[t._v("Simple tutorial to cover the entire process of compiling, uploading and interacting with a contract in the Osmosis blockchain. For this example we will use a project that was created with the "),s("a",{attrs:{href:"https://github.com/InterWasm/cw-template",target:"_blank",rel:"noopener noreferrer"}},[t._v("cw-template"),s("OutboundLink")],1),t._v(" repo.")]),t._v(" "),s("h2",{attrs:{id:"clone-osmosis-cw-template"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#clone-osmosis-cw-template"}},[t._v("#")]),t._v(" Clone osmosis-cw-template")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("git clone https://github.com/osmosis-labs/osmosis-cw-template\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"compile-the-wasm-contract-with-stable-toolchain"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compile-the-wasm-contract-with-stable-toolchain"}},[t._v("#")]),t._v(" Compile the wasm contract with stable toolchain")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("rustup default stable\ncargo wasm\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("After this compiles, it should produce a file in "),s("code",[t._v("target/wasm32-unknown-unknown/release/osmosis_cw_tpl.wasm.")]),t._v(" A quick ls -lh should show around 1.8MB. This is a release build, but not stripped of all unneeded code. To produce a much smaller version, you can run this which tells the compiler to strip all unused code out:")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("RUSTFLAGS='-C link-arg=-s' cargo wasm\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("This produces a file about 149kB. We will do further optimisation below.")]),t._v(" "),s("h3",{attrs:{id:"optimized-compilation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#optimized-compilation"}},[t._v("#")]),t._v(" Optimized Compilation")]),t._v(" "),s("p",[t._v("To reduce gas costs, the binary size should be as small as possible. This will result in a less costly deployment, and lower fees on every interaction. Luckily, there is tooling to help with this. You can optimize production code using rust-optimizer. rust-optimizer produces reproducible builds of CosmWasm smart contracts. This means third parties can verify the contract is actually the claimed code.")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('sudo docker run --rm -v "$(pwd)":/code \\\n    --mount type=volume,source="$(basename "$(pwd)")_cache",target=/code/target \\\n    --mount type=volume,source=registry_cache,target=/usr/local/cargo/registry \\\n    cosmwasm/rust-optimizer:0.12.6\n \n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("Binary will be at artifacts folder and its size will be 138k")]),t._v(" "),s("h2",{attrs:{id:"upload-wasm-contract-to-the-blockchain"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#upload-wasm-contract-to-the-blockchain"}},[t._v("#")]),t._v(" Upload wasm contract to the Blockchain")])])}),[],!1,null,null,null);e.default=r.exports}}]);