(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{475:function(s,t,a){"use strict";a.r(t);var n=a(8),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"javascript-smart-contracts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#javascript-smart-contracts"}},[s._v("#")]),s._v(" Javascript & Smart Contracts")]),s._v(" "),a("p",[s._v("This guide describes interacting with Osmosis Smart contracts via JavaScript runtimes such as Node.js and the browser.")]),s._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[s._v("#")]),s._v(" Prerequisites")]),s._v(" "),a("ul",[a("li",[s._v("npm and node.js")]),s._v(" "),a("li",[s._v("localosmosis - Not needed when connecting to mainnet)")]),s._v(" "),a("li",[s._v("Keplr browser not used on the guide yet")])]),s._v(" "),a("p",[s._v("Start a new project")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init -y\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Install cosmwasm")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i cosmwasm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Open the package.json file in a code editor and add")]),s._v(" "),a("div",{staticClass:"language-json= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('"type": "module",.\n\n  {\n        // ...\n        "type": "module",\n        // ...\n    }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("Create a new index.ts file")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" index.ts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("The class CosmWasmClient is exported from the CosmJS package @cosmjs/cosmwasm-stargate. Learn more in the "),a("a",{attrs:{href:"https://cosmwasm.github.io/CosmWasmJS/clients/reading/CosmWasmClient.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("offical docs"),a("OutboundLink")],1),s._v(".")]),s._v(" "),a("div",{staticClass:"language-javascript= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('import { CosmWasmClient } from "cosmwasm";\n\n// This is your rpc endpoint\nconst rpcEndpoint = "http://localhost:26657/";\n\nasync function main() {\n  const client = await CosmWasmClient.connect(rpcEndpoint);\n  console.log(client);\n}\n\nmain();\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v(":: tip\nYou can also connect to the mainnet by replacing rpcEndpoint to https://rpc.osmosis.zone/ "),a("a",{attrs:{href:"https://docs.osmosis.zone/developing/network/public-endpoints.html#official-endpoints",target:"_blank",rel:"noopener noreferrer"}},[s._v("Learn more here."),a("OutboundLink")],1),s._v("\n::")]),s._v(" "),a("h2",{attrs:{id:"run-it"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#run-it"}},[s._v("#")]),s._v(" Run it")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm index.js\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("You should see something like:\n"),a("img",{attrs:{src:"https://hackmd.io/_uploads/BJSUggXD9.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"other-methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#other-methods"}},[s._v("#")]),s._v(" Other methods")]),s._v(" "),a("p",[s._v("As documented on the "),a("a",{attrs:{href:"https://cosmwasm.github.io/CosmWasmJS/clients/reading/CosmWasmClient.html#available-methods",target:"_blank",rel:"noopener noreferrer"}},[s._v("official docs"),a("OutboundLink")],1),s._v(".")]),s._v(" "),a("div",{staticClass:"language-javascript= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('async function moreExamples() {\n  const client = await CosmWasmClient.connect(rpcEndpoint);\n  const chainId = await client.getChainId()\n  const getHeight = await client.getHeight()\n  const getAccount = await client.getAccount("osmo1phaxpevm5wecex2jyaqty2a4v02qj7qmlmzk5a")\n  const getSequence = await client.getSequence("osmo1phaxpevm5wecex2jyaqty2a4v02qj7qmlmzk5a")\n  const getBlock = await client.getBlock(1)\n  const getBalance = await client.getBalance("osmo1phaxpevm5wecex2jyaqty2a4v02qj7qmlmzk5a","uosmo")\n\n  console.log(chainId);\n  console.log(client);\n  console.log(getHeight);\n  console.log(getAccount);\n  console.log(getSequence);\n  console.log(getBlock);\n  console.log(getBalance);\n}\n\nmoreExamples();\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h2",{attrs:{id:"transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#transactions"}},[s._v("#")]),s._v(" Transactions")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Method")]),s._v(" "),a("th",[s._v("Description")]),s._v(" "),a("th",[s._v("Params")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v(".getTx()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("id: string")])]),s._v(" "),a("tr",[a("td",[s._v(".searchTx()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("query: SearchTxQuery, filter: SearchTxFilter = {}")])]),s._v(" "),a("tr",[a("td",[s._v(".txsQuery()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("query: string")])])])]),s._v(" "),a("h2",{attrs:{id:"codes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#codes"}},[s._v("#")]),s._v(" Codes")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Method")]),s._v(" "),a("th",[s._v("Description")]),s._v(" "),a("th",[s._v("Params")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v(".getCodes()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("none")])]),s._v(" "),a("tr",[a("td",[s._v(".getCodeDetails()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("codeId: number")])])])]),s._v(" "),a("h2",{attrs:{id:"smart-contracts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#smart-contracts"}},[s._v("#")]),s._v(" Smart Contracts")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Method")]),s._v(" "),a("th",[s._v("Description")]),s._v(" "),a("th",[s._v("Params")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v(".getContracts()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("cideId: number")])]),s._v(" "),a("tr",[a("td",[s._v(".getContract()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("address: string")])]),s._v(" "),a("tr",[a("td",[s._v(".queryContractRaw()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("address: string, key: Uint8Array")])]),s._v(" "),a("tr",[a("td",[s._v(".queryContractSmart()")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("address: string, queryMsg: Record<string, unknown>")])])])]),s._v(" "),a("h1",{attrs:{id:"querying-smart-contracts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#querying-smart-contracts"}},[s._v("#")]),s._v(" Querying Smart Contracts")]),s._v(" "),a("p",[s._v("Before we query smart contracts in localOsmosis we must "),a("a",{attrs:{href:"https://docs.osmosis.zone/developing/dapps/get_started/cosmwasm-localosmosis.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("deploy one by following this guide"),a("OutboundLink")],1),s._v(".")]),s._v(" "),a("p",[s._v("Once you have deployed the smart contract you can get the "),a("code",[s._v("<CONTRACT-ID>")]),s._v(" by running:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("osmosisd query wasm list-code\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("You can now get the contract address by running")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("osmosisd query wasm list-contract-by-code <CONTRACT-ID>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" CosmWasmClient "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cosmwasm"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// This is your rpc endpoint")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" rpcEndpoint "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost:26657/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryContract")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" client "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" CosmWasmClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("connect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rpcEndpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" getContract "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getContract")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CONTRACT_ADDRESS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("getContract"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryContract")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("Run the code")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("node index.js\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("The output should look like this:\n"),a("img",{attrs:{src:"https://hackmd.io/_uploads/r1MufGXw9.png",alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);